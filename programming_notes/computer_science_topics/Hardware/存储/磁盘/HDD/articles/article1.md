
# 1

磁盘I/O那些事 https://tech.meituan.com/2017/05/19/about-desk-io.html
- > **影响硬盘性能的因素**
  * > **1. 寻道时间**
  * > **2. 旋转延迟**
  * > **3. 数据传输时间**
- > **衡量性能的指标**
  * > ***机械硬盘的连续读写性能很好，但随机读写性能很差，这主要是因为磁头移动到正确的磁道上需要时间，随机读写时，磁头需要不停的移动，时间都浪费在了磁头寻址上，所以性能不高***。衡量磁盘的重要主要指标是`IOPS`和`吞吐量`。
  * > **1. IOPS**
    + > ***`IOPS`（`Input/Output Per Second`）即每秒的输入输出量（或读写次数），即指每秒内系统能处理的I/O请求数量。<ins>随机读写频繁的应用，如`小文件存储`等，关注随机读写性能，IOPS是关键衡量指标</ins>***。可以推算出磁盘的 `IOPS = 1000ms / (Tseek + Trotation + Transfer)`，如果忽略数据传输时间，理论上可以计算出随机读写最大的IOPS。常见磁盘的随机读写最大IOPS为：
      ```console
      7200rpm的磁盘 IOPS = 76 IOPS
      10000rpm的磁盘IOPS = 111 IOPS
      15000rpm的磁盘IOPS = 166 IOPS
      ```
  * > **2. 吞吐量**
    + > ***`吞吐量`（`Throughput`），指单位时间内可以成功传输的数据数量。<ins>顺序读写频繁的应用，如`视频点播`，关注连续读写性能、数据吞吐量是关键衡量指标</ins>。它主要取决于磁盘阵列的架构，通道的大小以及磁盘的个数***。不同的磁盘阵列存在不同的架构，但他们都有自己的内部带宽，一般情况下，内部带宽都设计足够充足，不会存在瓶颈。***磁盘阵列与服务器之间的数据通道对吞吐量影响很大，比如一个`2Gbps`的光纤通道，其所能支撑的最大流量仅为`250MB/s`***。最后，当前面的瓶颈都不再存在时，硬盘越多的情况下吞吐量越大。
- > **操作系统层的优化**
- > **虚拟文件系统层（VFS Layer）**
- > **Ext2文件系统**
- > **Page Cache层**
- > **通用块层**
- > **I/O调度层**
- > **块设备驱动层**
- > **基于磁盘I/O特性设计的技巧**
  * > **采用追加写**
  * > **文件合并和元数据优化**
    + > **小文件合并**
    + > **元数据管理优化**
