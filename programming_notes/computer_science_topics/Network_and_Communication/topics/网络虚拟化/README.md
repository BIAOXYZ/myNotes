
# vxlan

Virtual Extensible LAN (VXLAN) https://en.wikipedia.org/wiki/Virtual_Extensible_LAN

Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks https://tools.ietf.org/html/rfc7348

【from cizixs】：
- vxlan 协议原理简介 https://cizixs.com/2017/09/25/vxlan-protocol-introduction/
- linux 上实现 vxlan 网络 https://cizixs.com/2017/09/28/linux-vxlan/

VXLAN vs VLAN - 肖宏辉的文章 - 知乎 https://zhuanlan.zhihu.com/p/36165475

【[:star:][`*`]】 关于VLAN和VXLAN的理解 https://blog.csdn.net/octopusflying/article/details/77609199
- > VLAN (Virtual Local Area Network)意为虚拟局域网，是在交换机实现过程中涉及到的概念，由802.1Q标准所定义。由于交换机是工作在链路层的网络设备，连接在同一台交换机的终端处于同一个三层网中，同时也处于同一个广播域。当交换机接入较多的终端时，任意一台终端发送广播报文时（例如：ARP请求），报文都会传遍整个网络。对于规模较大的组网场景，广播报文的泛滥对于网络通信将会造成较大的影响。VLAN技术为这一问题提供了解决方案，***`VLAN将同一网络划分为多个逻辑上的虚拟子网，并规定当收到广播报文时，仅仅在其所在VLAN中进行广播从而防止广播报文泛滥。VLAN技术在链路层的层次中实现了广播域的隔离。`***
- > VLAN标准涉及到的RFC文献有2个：rfc3069、rfc5517。rfc3069阐述了利用VLAN技术来优化子网划分并节省IP地址数目的方案；rfc5517则给出了Cisco提出的私有VLAN的标准以满足网络安全方面的需求。
<br> 802.1Q标准所定义的以太网帧格式在基于传统以太网帧格式中添加了描述VLAN信息的字段，帧格式如下：
<br> ![](https://img-blog.csdn.net/20170826223653686?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvb2N0b3B1c2ZseWluZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
- > VXLAN(Virtual eXtential LAN)意为虚拟可拓展局域网。随着大数据、云计算技术的兴起以及虚拟化技术的普及，VLAN技术的弊端逐渐显现出来，具体表现为如下3个方面：
  * > (1) 虚拟化技术的发展促使大数据、云计算技术公司采用单个物理设备虚拟多台虚拟机的方式来进行组网，***`随着应用模块的增加，对于支持VLAN数目的要求也在提升，802.1Q标准中的最多支持4094个VLAN的能力已经无法满足当下需求。`***
  * > (2) 公有云提供商的业务要求将实体网络租借给多个不同的用户，这些用户对于网络的要求有所不同，而不同用户租借的网络有很大的可能会出现IP地址、MAC地址的重叠，***`传统的VLAN仅仅解决了同一链路层网络广播域隔离的问题，而并没有涉及到网络地址重叠的问题`***，因此需要一种新的技术来保证在多个租户网络中存在地址重叠的情况下依旧能有效通信的技术。
  * > (3) 虚拟化技术的出现增加了交换机的负担，对于大型的数据中心而言，单台交换机必须支持数十台以上主机的通信连接才足以满足应用需求，而虚拟化技术使得单台主机可以虚拟化出多台虚拟机同时运行，***`而每台虚拟机都会有其唯一的MAC地址。这样，为了保证集群中所有虚机可以正常通信，交换机必须保存每台虚机的MAC地址，这样就导致了交换机中的MAC表异常庞大，从而影响交换机的转发性能。`***
- > 文档rfc7348详细地介绍了VXLAN的实现机制。本质上VXLAN是一种隧道技术。通过将虚拟网络中的数据帧封装在实际物理网络中的报文中进行传输。具体实现方式为：将虚拟网络的数据帧添加VXLAN首部后，封装在物理网络中的UDP报文中，然后以传统网路络的通信方式传送该UDP报文，到达目的主机后，去掉物理网络报文的头部信息以及VXLAN首部，将报文交付给目的终端。整个通信过程目的终端不会感知到物理网络的存在。
<br> 利用VXLAN技术组网的方法可以用下图来描述：

:u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307::u6307:

网卡VXLAN的offload技术介绍 https://www.cnblogs.com/dream397/p/14498557.html || https://itcn.blog/p/1649447404570543.html
- > 首先要从术语 `offload` 说起，offload指的是将一个本来有软件实现的功能放到硬件上来实现，这样就可以将本来在操作系统上进行的一些数据包处理（如分片、重组等）放到网卡硬件上去做，降低系统CPU消耗的同时，提高处理性能。

:u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272:

# Overlay

为什么集群需要 Overlay 网络 https://draveness.me/whys-the-design-overlay-network/
- > **虚拟机迁移**
  * > 当虚拟机所在的宿主机因为维护或者其他原因宕机时，当前实例就需要迁移到其他的宿主机上，为了保证业务不中断，我们需要保证迁移过程中的 IP 地址不变，因为 Overlay 是在网络层实现二层网络，所以多个物理机之间只要网络层可达就能组建虚拟的局域网，虚拟机或者容器迁移后仍然处于同一个二层网络，也就不需要改变 IP 地址。

Underlay、Overlay、大二层介绍 - 网络菜鸟薛的文章 - 知乎 https://zhuanlan.zhihu.com/p/32486650
- > server-virtualization 技术把物理服务器虚拟化成多个虚拟机，企业应用部署在虚拟机上，hypervisor/VMM用来监控虚拟机状态，当故障即将来了的时候，hypervisor通过相关技术（vmotion、live migration）把运行在当前物理机上的虚拟机迁移到其他物理机上。**虚机迁移这个动作对用用户是透明的，<ins>所以在迁移前后必须保证虚机的 `MAC/IP` 是保持不变的</ins>。这样就意味着迁移必须在一个二层广播域内完成。（一个IP子网=一个广播域）**

什么是Overlay网络？ https://network.51cto.com/article/702624.html
- > ***Underlay网络可以是二层也可以是三层网络***。其中二层网络通常应用于以太网，通过VLAN进行划分。三层网络的典型应用就是互联网，其在同一个自治域使用OSPF、IS-IS等协议进行路由控制，在各个自治域之间则采用BGP等协议进行路由传递与互联。随着技术的进步，也出现了使用MPLS这种介于二三层的WAN技术搭建的Underlay网络。

:u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272:
