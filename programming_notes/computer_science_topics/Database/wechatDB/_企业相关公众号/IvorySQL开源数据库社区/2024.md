
# 07

了解 PostgerSQL 的门户 – Executor vs Process Utility https://mp.weixin.qq.com/s/YQsQg5H063GzpMDjJJQIaQ
- >  当您向 PostgreSQL 发送查询时，查询会依次经历多个处理阶段，并在最后返回结果。这些阶段称为：
  ```console
  解析
  分析
  重写
  计划
  执行
  ```
- > 在另一篇文章中，我简要概述了PostgreSQL在每个查询处理阶段的主要责任。你可以在这里找到它。 https://www.highgo.ca/2024/01/26/a-comprehensive-overview-of-postgresql-query-processing-stages/
- > 在这篇文章中。有一个主要聚焦规划器模块的功能，您可以在此处找到。 https://www.highgo.ca/2024/03/22/understand-postgresqls-planner-simple-scan-paths-vs-plans/
- > 在这篇博客中，我们将重点介绍查询处理的执行器部分，作为连接 PostgreSQL 内部模块的关键枢纽，执行器负责协调并收集查询所需的确切数据。
- > ***实际上，将执行器用于描述查询处理的这一阶段并不准确。在 PostgreSQL 源代码中，这一角色更多地被整合在名为“portal”的对象框架内***。通常，***它有 2 条潜在的路径，即“执行器”路径或“指令处理器”路径***。
- > 通常情况下，我们只是将此阶段称为“执行器”而不是“门户”，因为执行器处理大多数涉及 SELECT、INSERT、UPDATE、DELETE 的 DML 查询类型......等等，它必须根据“planner”模块创建的查询计划来处理它们。
- > 另一方面，”指令处理器”并不依赖于“计划器”生成的查询计划来执行流程，而是直接处理DDL（数据定义语言）操作以及其他非DML（数据操纵语言）的查询类型，例如 VACUUM、CREATE、PREPARE ...等。
- > 就所涉及的逻辑而言，门户（或执行器）并不像计划器那么复杂，但它同样是PostgreSQL内部架构中不可或缺的一环，因为它需要协调众多其他模块共同协作，确保能够准确地处理并产生查询的正确输出。让我们来看看。
- > **1 一切从这里开始**
  * > `postgres.c` 中的函数 `exec_simple_query（）` 函数 是查询处理阶段的关键环节。我们将重点关注 在调用 `PortalStart（）` 函数之后会发生什么。
