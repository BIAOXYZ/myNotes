
# 11

使用GDB分析PostgreSQL https://mp.weixin.qq.com/s/39R8ve0TP8I-x5p5jew0TQ
- > **使用GDB调试coredump**
- > **使用GDB命令**
  * > The `x` (examine) command
    + > `x` 命令用来检查一个具有指定大小和格式的内存块内容。下面的例子试图检查一个 `HeapTuple` 结构体中的 `t_data` 值。注意，我们首先打印 `*tup` 指针以了解 `t_data` 的大小为176，然后我们使用 `x` 命令检查 `t_data` 所指向的前176个字节
      ```sh
      (gdb)  p *tup$6 = {t_len = 176, t_self = {ip_blkid = {bi_hi = 65535, bi_lo = 65535}, ip_posid = 0}, t_tableOid = 0,  t_data = 0x55ba8290f790}(gdb)  p tup->t_data$7 = (HeapTupleHeader) 0x55ba8290f790(gdb) x/176bx  tup->t_data0x55ba8290f790: 0xc0    0x02    0x00    0x00    0xff    0xff    0xff    0xff0x55ba8290f798: 0x47    0x00    0x00    0x00    0xff    0xff    0xff    0xff0x55ba8290f7a0: 0x00    0x00    0x1f    0x00    0x01    0x00    0x20    0xff0x55ba8290f7a8: 0xff    0xff    0x0f    0x00    0x00    0x00    0x00    0x000x55ba8290f7b0: 0x0a    0x40    0x00    0x00    0x74    0x65    0x73    0x740x55ba8290f7b8: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7c0: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7c8: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7d0: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7d8: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7e0: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7e8: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f7f0: 0x00    0x00    0x00    0x00    0x98    0x08    0x00    0x000x55ba8290f7f8: 0x01    0x40    0x00    0x00    0xff    0xff    0x00    0x630x55ba8290f800: 0x43    0x00    0x01    0x2c    0x08    0x40    0x00    0x000x55ba8290f808: 0x00    0x00    0x00    0x00    0x09    0x40    0x00    0x000x55ba8290f810: 0xf2    0x08    0x00    0x00    0xf3    0x08    0x00    0x000x55ba8290f818: 0x62    0x09    0x00    0x00    0x63    0x09    0x00    0x000x55ba8290f820: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x000x55ba8290f828: 0x00    0x00    0x00    0x00    0x64    0x78    0x00    0x000x55ba8290f830: 0x00    0x00    0x00    0x00    0xff    0xff    0xff    0xff0x55ba8290f838: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00(gdb)
      ```
  * > 前文译自：https://www.highgo.ca/2020/11/07/how-to-analyze-a-postgresql-crash-dump-file/
- > **后记**
  * > PostgreSQL不像Oracle，***出了故障需要溯源时，Oracle得益于各种强大的分析工具比如`AWR`、`ASH`等，往往在数据库里面就能分析个七七八八***，PostgreSQL没有如此强大的功能，需要经常和操作系统打交道，Linux首当其冲。作为DBA，还是需要了解一下常用的工具
