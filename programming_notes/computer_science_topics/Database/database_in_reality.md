
# 待分类

每秒最多 6.5 万个事务，我们的 PostgreSQL 12 迁移之路 https://mp.weixin.qq.com/s/jNlbyLUFEGk5LMsQjrKkuw

~~国产数据库里程碑事件：4.2 亿、易鲸捷中标「贵阳银行」核心业务系统，替换 Oracle https://mp.weixin.qq.com/s/gC1wlVHtNNFuYdLlTKY-5A~~  -->  4.2 亿、贵阳银行「国产数据库」大单：易鲸捷替掉 IBM Informix https://mp.weixin.qq.com/s/Cf75dMz6b6IzPJUEm83g_Q

国产数据库的里程碑式新突破：贵阳银行核心系统4.2亿订单采购易鲸捷 https://www.modb.pro/db/34022
- > 摘要：昨日（2020年10月19日），贵阳银行发布上市公司公告，核心业务系统易鲸捷国产数据库应用项目，成交金额 426，664，400，创造了国产数据库的单一采购项目记录，是国产数据库的里程碑式新突破。
- > 全文链接：https://www.modb.pro/doc/6358
- > 2020年10月19日，贵州省招投标公共服务平台(ztb.guizhou.gov.cn)发布《贵阳银行核心业务系统易鲸捷国产数据库应用项目成交公告》， 确定贵州易鲸捷信息技术有限公司(以下简称“贵州易鲸捷”)为“贵阳银行核心业务系统易鲸捷国产数据库应用项目”的成交供应商。

顺德农商银行采用阿里数据库 OceanBase ，启动核心系统分布式改造 https://www.ithome.com/0/497/389.htm
- > IT之家 7 月 12 日消息 日前，顺德农商银行携手阿里云和蚂蚁集团正式开启了首批互联网金融、II、III 类银行结算账户，以及在线信贷等核心业务系统迁移工作，将这些业务系统逐渐从传统的 IOE 架构迁移到金融云平台之上。

# 去O

争议 | 国产数据库能否替换 Oracle 数据库？ https://mp.weixin.qq.com/s/ddJISAyT3f3WFHPZqzmPdA

openGauss可替代Oracle吗？从字段类型说起…… https://mp.weixin.qq.com/s/bIHbamDCLLmYJIsdJxKfjA

南方电网单一来源 Oracle、Redhat：因国产数据库、操作系统无法完全替代、存在差距 
- 2020-08-05 23:07:02 https://www.yuntoutiao.com/detail/i_5f2acb16e4b0d6e16a29bda3/1 || https://mp.weixin.qq.com/s/q0ySnzYtsVAQyA3gB28JAw
  >> 注：云头条官网版本不可见内容；微信公众号版本直接说违规。
- 来源：新浪财经头条发布时间：2020年08月05日 https://news.tianyancha.com/ll_4nm301ia8b.html
  * > 2020年7月28日，南方电网公司2020年信息类软件框架采购项目单一来源采购公示发布，（采购编号：0006200000071181）。采购人为中国南方电网有限责任公司。 项目概况 按公司2020年集团物资集中采购工作计划，公司总部、超高压公司、广东电网公司、广西电网公司、云南电网公司、贵州电网公司、海南电网公司、深圳供电局、调峰调频公司、产业投资集团、南网数研院、鼎元资产公司、南网能源公司、资...
  >> 注：天眼查版本只有一个摘要了；天眼查版本是从新浪财经头条转载的，原链接也删了。
- https://www.jasve.com/zh-tw/cnsfinnianl/0c805b9a6fa03dd544e54cd0d31ce02a.html
  * > 3、大型關係型資料庫（Oracle）單一來源採購理由：
    + > 公司原有的企業級管理系統和當前數字電網建設相關係統主要以Oracle資料庫為主；目前，國產資料庫在部分關鍵效能和高可用等方面，尤其在共享儲存叢集技術（RAC）、儲存過程及專用函式上與Oracle產品仍存在一定差距，在一定時期內國產同類產品仍無法實現對Oracle產品的全面替換；Oracle資料庫是由美國甲骨文公司提供的軟體產品，是目前最流行的資料庫之一，也是目前世界上使用最為廣泛的資料庫管理系統。Oracle大型關係型資料庫具有共享儲存叢集、多租戶、In-Memory、JSON支援、分片、自治雲服務、多模資料庫等特性，支援事務、實時分析等操作型資料庫用例，可提供卓越的效能、可擴充套件性、可靠性和安全性，以支援所有操作型負載和分析型負載，在資料庫身份鑑別、訪問控制、安全審計方面等方面具有完備的安全保護能力，滿足“等保2.0”資料保護標準評測。
  >> 注：只能搜到这么一个（还是繁体字）网站上还有原文了。。。

阿里 OceanBase 在关键领域不可能替代 Oracle https://mp.weixin.qq.com/s/73t798-DN6V86LJgrY5I9g

# 数据库测评

中国信通院公布上半年国内数据库产品和服务商第一梯队，含华为、阿里、腾讯 https://www.ithome.com/0/701/784.htm
- > IT之家 6 月 25 日消息，中国信息通信研究院举办 2023 上半年“可信数据库”评测专家评审会，共计 28 家企业的 33 款产品通过本次评审。
- > 本次通过基础能力评测的包括 6 款搜索型数据库、5 款分布式事务型数据库、3 款分布式分析型数据库、3 款全密态数据库、2 款时序数据库、2 款时空数据库、2 款图数据库、1 款关系型云数据库和 1 款数据库一体机；通过性能评测的包括 3 款分布式分析型数据库、2 款集中式事务型数据库、1 款分布式分析型数据库（大规模）、1 款分布式事务型数据库和 1 款时序数据库；通过稳定性评测的包括 1 款分布式分析型数据库和 1 款分布式事务型数据库。此外，通过分布式数据库运维管理能力成熟度模型评估的共 1 家企业。

# 数据库事件

## 2024

当事人复盘 GitLab 史上最严重的数据库故障 https://mp.weixin.qq.com/s/Y7qAaYt2uIylqlPve9DGzg
- > 故事来源于当事人最近发表的回忆录 https://yorickpeterse.com/articles/what-it-was-like-working-for-gitlab/ ，相关节选。
- > GitLab 官网上还有当年这次事故的纪录。 https://about.gitlab.com/blog/2017/02/01/gitlab-dot-com-database-incident/ ，事件发生在 2018 年 2 月 1 日。
- > **02.恢复过程**
  * > GitLab 官方提到有好几道防线，所以最后还是恢复了过来。不过就像一开始当事人回忆里提到的，差一点点就完蛋了。事实上 GitLab 设置的所有防线其实都被击穿了：
    + > 每天的自动备份不奏效，因为备份所用的 pg_dump 版本和 GitLab 的 PG 版本不一致，所以每次备份只产生了几个 bytes 的数据。
    + > 在 Azure 上的磁盘备份没有在数据库服务器上启用。
    + > 到 S3 的备份也是坏的，目录为空。
  * > ***所幸的是，当事人在操作前的 6 小时，因为知道要处理数据库负载均衡问题，所以做了一个手工备份***。所以最后 GitLab.com 花了 24 个小时，把这个手工备份恢复了出来，***但是 6 小时的数据是完全没了***。
- > **03.复盘**
  * > 1.***备份恢复需要定期演练。<ins>不演练还不如不要备份</ins>***。这点其实也从侧面体现了云数据库服务商的优势。因为他们能够保障备份的有效性，也提供了 Point-in-time-recovery (PITR) 这样的闪回能力。GitLab 是自己在云主机上搭了数据库服务，手搓一套备份/恢复的方案，结果完全不可用。
  * > 2.***不要在疲劳时操作数据库***。当事人本来已经因为时间很晚，准备休息了。但因为突然出现的同步问题，继续熬夜。
  * > 3.尽可能通过工具而不是人肉操作。GitLab 的这个故障应该是当事人直接登上服务器，进行命令行操作的。这里至少有 2 个卡点可以引入工具，一个是登陆服务器，一个是登陆后在服务器上执行命令。如果通过工具操作的话，工具界面会提示正在操作生产库，并且进一步可以设置审批流程。
  * > 4.危险操作事前先备份。这个故障可以挽回在于当事人还是一个老手，所以做了事前手工备份，否则后果不堪设想。
- > 前段时间 Linear 误用 `TRUNCATE` 也造成了其史上最大故障。对生产环境，尤其是数据库上的操作永远要心怀敬畏。操作时应该尽量通过工具自动化。万不得已需要手动挡，始终也要确保有可用备份兜底。
  >> 【[:star:][`*`]】 //notes：但是 Linear 事故反而（部分）因为用了自动化工具没有提示。。。

因为意外删库，这家软件届的爱马仕遭遇了成立 5 年来的最大故障 https://mp.weixin.qq.com/s/4MDdQAEL7H-3p-b8Zz8c6Q || 这家软件届的爱马仕，遭遇了成立 5 年来的最大故障，元凶还是它 https://mp.weixin.qq.com/s/ShYpGMwrqige2bvmfO8ZRg
- > **03.故障原因**
  * > 导致删数据的是这条语句 `TRUNCATE TABLE <new_table> CASCADE;`
  * > `CASCADE` 关键词会把所有有外健关联到 new_table 的表数据都清空掉。
  * > 上面我们简单模拟了一下场景，可以看到当我们 `TRUNCATE t CASCADE` 后，会把 `ref_t` 的数据也都清空。***我们看到通过命令行操作是有提示的***，但是变更生产环境的流程通常不会采用命令行直连的方式。
- > **05.故障影响面**
  * > 从故障发生的 1.24 到发出复盘报告的 1.30，整个团队显然是在连轴转 (work around the clock)。
- > **06.故障反思**
  * > 读罢 Linear 的整个报告，还是要感慨它的透明度，所谓的 **blameless postmortem**（对事不对人的复盘）在这个报告中体现的淋漓尽致。再联想到去年国内上热搜的大故障，即使到现在，好多官方也没有一个正式的故障复盘。可能因为定责到个人，个人背后有主管，会影响到绩效，绩效挂钩奖金和晋升，各种利益夹杂在一起，就很难开诚布公地聊了。定责在国内是一种约定俗成，现阶段也很难去改变它，下次再写写怎么样让定责可以更加的客观吧。

## 2023

### 易鲸捷贵阳银行交付失败事件

数据库真被卡脖子了吗？ https://mp.weixin.qq.com/s/vh1JE_BdaLetWtt5vvPDDw
- 回复里的：
  * > 写得很好！我们在图数据库领域，放眼望去，绝大多数都是骗子。各种话术、各种PPT创业、各种皇帝数据库。什么性能、什么功能、什么正确性，全都是世界顶级。要我说、中国的数据库从业者应该被办法诺贝尔文学、物理学、化学心理学、和平奖！
  * > 补充一点，数据库内核，不仅仅是关系型内核。在非关系型内核上，真正投入日经历开发的少之又少。光搞生态和扩展，能有门槛才见鬼。
  * > 国产数据库让你真正理解什么叫“关系型”数据库
    >> 【[:star:][`*`]】 //notes：这句亮了。。。
  * > 易鲸捷造假被发现
    >> 易鲸捷还没倒闭？？

国产数据库们，卷死在沙滩上。。。 https://mp.weixin.qq.com/s/gbJ3H8g2tPauIQRH140pcQ
- > 我也能理解为什么不准确，因为叫华为高斯的，就好几个版本了。内核都不一样，但是名字一样，李逵和李鬼都是一家公司出来的，谁能分得清楚哪个是李逵，哪个是李鬼？
- > 不管你信不信，基于PG也就是PostgreSQL的各种国产数据库，林林总总就有不知道多少个了。那么基于MySQL的呢？基于其他各种大数据开源项目比如ClickHouse，Trino，Doris等等，的OLAP数据仓库大数据产品呢？

谣传易鲸捷的数据库是套牌的Oracle。。。 https://mp.weixin.qq.com/s/zFV3joP5Q4S2y32ZaghqPQ
- > 其实这个东西易鲸捷自己也没藏着。易鲸捷的产品`EsgynDB`主要来源于`Apache Trafodion`。
- > Apache Trafodion这个项目，说实在的，没多少人去搭理。这个项目是HP开源出来的，提供了一个`SQL on HBase`的解决方案，主要是支持`OLTP`的数据处理。
- > 这东西老本家是一家叫做`Tandem`的公司，可能很多人都不知道这家公司怎么回事。其实在数据库历史上还是很重要的一家公司。我们耳熟能详的比如图灵奖获得者`Jim Gray`以及我认为非常牛逼的`Graefe Goetz`等人，都曾经在这家公司干过。
- > 这家公司的产品叫做`NonStop SQL/MP`，***也就是世界上第一个MPP架构的分布式数据库***。公司在最鼎盛的时期也没干过其他几家数据库公司比如Oracle，IBM，Informix。后面就衰弱了。
- > 公司后来被做PC的康柏给买了，然后康柏和HP合并以后，又成为了HP的一部分。而后的事情，HP并没有怎么重视这套产品线。虽然也一直有投入，比如说做了NonStop SQL的OLAP版本`Neoview`。OLTP版本也改名叫做`SeaQuest`。
- > 那么易鲸捷为什么会选择这个项目呢。理由也很简单。易鲸捷首席技术架构师叫刘明。这位在HP做的就是Apache Trafodion以及之前Tandem被HP买进来的各种数据库产品，在HP干了15年。
- > 所以可以很自然想象，该公司的产品，基于的是什么技术，以及为什么基于这些技术。我在企查查上看到易鲸捷公司不到100人，而刘明看起来已经不在公司里了。

易鲸捷是套壳 Oracle 数据库吗？ https://mp.weixin.qq.com/s/1UnC0IZ_Ns91J1mmXaD9pg
- > 易鲸捷大概是 2016 年左右创业的，在其官方公众号上自称数据库技术来自于开源项目 Trafodion。该 Trafodion最早可以追溯到 80 年代的天腾电脑（Tandem Computers）推出的NonStop SQL，和甲骨文（Oracle）是同时代、技术类似的事务处理关系型数据库（OLTP）软件，在 80 年代末相当有名；天腾是总部在硅谷的、70 年代创业的 OLTP服务器公司，生产银行、电信、公安等关键行业的高容错服务器，最高峰时期有上万人，NonStop 是天腾产品线的名称。90 年代末，天腾电脑被新兴的 PC 厂商康柏收购，成为康柏的服务器部门；几年后康柏电脑又被惠普收购，NonStop 成为惠普服务器的一条产品线，而数据库软件 NonStop SQL 就成为惠普的资产，2011 年后，惠普这条产品线逐渐淡出市场。
- > 2014 年，惠普把NonStop 的一部分代码库开源，起名 Trafodion，积极介入Hadoop 生态，孵化 Hadoop 生态里的高性能、高可靠关系型数据库软件。2015 年加入开源组织 Apache 基金会，2018 年结束孵化成为 Apache的顶级项目。2021 年 4 月该开源项目宣布终止。
- > 在易鲸捷的官方公众号上可以看到在 2018 年前，该公司董事长是前惠普中国 CTO李为冲，还有很多文章宣传Apache Trafodion；而在领英上还可以看到一位 Ken Holt 标记为易鲸捷公司的联合创始人兼 COO，这位 Ken Holt 先生在 90 年代就是天腾电脑的开发工程师，2000 年加入惠普负责开发和产品管理直到 2015 年参加易鲸捷创业。美国 IT大厂的数据库软件开源项目负责人在中国创业数据库公司，我在业界就认识好几个。
- > 到 2019 年底，不知道什么原因，在易鲸捷的官方公众号的公开宣传报道上，董事长就换成了李静女士，同时，该公司产品线从 OLTP关系型数据库扩展到了 OLAP 以及 HTAP等主流数据库技术。
- > 并没有官方报道说贵州某银行的易鲸捷数据库项目搞不下去了，用 Oracle 数据库来接续替换，事实上，在易鲸捷项目开始前，该银行不可能没有数据库管理软件，从中国银行业的历史来看，是 Oracle 数据库的可能性还很大。至于该银行近日公布的新系统切换，究竟真相是怎样，希望今后会有官方说明，但是目前网络传言至少最基本事实是网上自媒体瞎编乱造的：易鲸捷应该是没有套壳 Oracle。
- 回复里的：
  * > 说一下我所了解情况，因一门课的导师邀请，当时在惠普做cto的李为冲成为课程的校外老师，其深度参与课程项目而熟悉。后他从惠普出来创业。带着团结几个核心在深圳出差，我们一帮师兄师姐师弟们聚了一下，具体聊了一下他离职原因，他是把惠普放弃的数据库团队带出来，想把惠普花了好几亿美金却继续不下去的项目在中国开花结果，让中国有自己的数据库才离职创业的。后来出现甲骨文老板大幅度裁员中国区技术团队，并给美国政府出谋划策要求美国出政策禁止美企给中国培养人才，要扼杀中国在互联网、软件跟人工智能方面的超越美国的机会。国产数据库成了国家当时急需要的，因为金融数据等基础软硬件咱们国家一直依赖ibm跟甲骨文，让我国摆脱对美依赖这也是李为冲的创业出发点之一。地方政府，特别是贵州在建设大数据中心，自然希望这种技术团队背景华丽的公司在贵州落地生根，本地产业首先支持高精尖科技公司，一直是地方政府的方式，不然怎么培育本土企业？。广州街头都是广汽埃安出租车，深圳都是比亚迪，北京都是现代，上海都是荣威。一个理，只是因为各种原因，团队散了而已。谁能保证每一个豪华团队一定成功呢？看了太多说易鲸捷套壳甲骨文的技术，真是很可笑。
  * > yjj第一版想用hdfs搞分布式oltp，现场搞了2年没结果（行业人士一开始就等着看笑话），接着再试图拿cockroach🪳来定制（套壳），最终发现还是故事讲不下去，花了重金敲锣打鼓娶了个不下蛋的回来，大冤种30个月终于兜不住了，无奈不得不冒着全网群嘲借腹生子
    >> 说实话我看到hbase上搞oltp第一反应就是瞎胡闹。。。
  * > 并行两套数据库，最后易没能完成运行上线的交付
  * > 套壳Oracle？难不成这么说的人以为大O的法务团队是吃素的么？这件事最主要的原因是作为银行系统，当年这四个多亿的单子没采用最成熟的Oracle，也没采用国内比较知名的其他数据库，而是选用了名不见经传的易，这其中的原因令人浮想联翩，大概率是有技术之外的因素起了决定性作用。在易的实际交付前及交付过程中，按照银行业的实际情况推测极大可能仍然有部分或全部系统在使用Oracle，被Oracle抓住了马脚，或者是易交付的不顺利最终银行仍然要选择O。毕竟当年那次采购易的合同额是四个多亿，这个价格即使按照PULA计费模式买O也是绰绰有余。
    >> 我一直认为国产化替代应该比买外国产品更贵才是，尤其是起步阶段。
    >>> 贵也应该有个限度吧。近几年国内各大银行数据库项目的采购金额都可以查到，基本上千万级别的单子在O看来就已经可以用ula模式计费了，易这个项目确实贵的离谱了。

骗取14亿！易鲸捷假国产何以持续8年才暴雷！（完整梳理）（转） https://mp.weixin.qq.com/s/QOU0byAI6SnWGf3KgBewqA

靠吹牛解决不了“卡脖子”！易鲸捷去“O”与贵阳银行回“O”！ https://mp.weixin.qq.com/s/DQCfDvu5CtXCOOhym6PnSQ

## 2020

### 郑大一附院锁表事件

一个违规操作、损失 800 万、被判五年半：运维夏某某致「郑大一附院」智慧医院系统瘫痪 2 个小时，判破坏计算机信息系统罪 https://mp.weixin.qq.com/s/5DnToow7lVjSvnQZ-r777w
- > 夏某某任职北京中科某某科技有限公司，负责该公司为郑大一附院开发的“软件信息系统”的维护工作。
- > 2017年10月31日20时许，夏某某参与并直接操作了郑大一附院“HIS数据库”的账号密码修改仪式，夏某某在未经授权或许可的情况下，私自记录了该账号密码。
- > 后夏某某在未经授权或许可的情况下，私自编写了“数据库性能观测程序”和锁表语句，并利用私自记录的账号密码将该程序私自连接郑大一附院“HIS数据库”，导致该锁表语句在“HIS数据库”运行。
- > 2018年12月24日8时13分至9时47分期间，夏某某先后六次利用“数据库性能观测程序”连接“平台数据库”的“锁定平台挂号表”功能，将数据库执行锁表命令。该命令执行后锁定`fin_opr_register`表，使其不能进行其它活动，并导致“HIS数据库”锁定。***造成郑大一附院郑东院区、惠济院区、医学院院区所有门诊、临床计算机业务受到恶意语句攻击，门急诊挂号、门急诊叫号、门急诊支付、门急诊药房、门急诊检查、门急诊检验等业务系统均无法正常操作，所有门诊相关业务停止服务，造成该医院三个院区门诊业务停滞近两个小时，造成大量患者积压在门诊无法就诊，严重影响医院的正常医疗工作***。
- > 案发后，夏某某对其工作数据日志、办公电脑进行了清理。
- > 2019年5月22日，经民警电话通知后被告人夏某某到郑州市公安局郑东分局投案。

这个“可能”是运维操作失误导致被判了 5 年的案例有点意思。 https://www.v2ex.com/t/664064
