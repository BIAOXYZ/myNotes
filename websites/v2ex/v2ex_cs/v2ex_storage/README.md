
对搭建 MinIO 对象存储的一些疑问 https://www.v2ex.com/t/1121050
- > minio 建公网上啊。。。 图啥？minio 用 nginx 负载均衡啊？ 图啥？
- > 都用阿里云了为啥不直接用 OSS ？又方便可靠性肯定比自己搭的高，容量和速度也不用担心。MINIO 一般自己内网/有自己物理服务器搭比较适合。ECS 按流量 0.8/g ，OSS 0.5/g
  >> 感谢回复，目前是 OSS 和 MinIO 都在使用，现在 MinIo 是在阶段性尝试，只有一小部分数据在上边。我刚才翻了一下文档，确实是 ECS 按流量 单价：0.80 元/GB 。
  >>> #10 另外，阿里云的 OSS 搭配阿里云的 CDN ，我记得价格最低可以节省到 0.15 左右。自建何必
- > 我们之前用 `Ceph` 试过，并没有比云厂商的 OSS 服务更好。你节省的那点流量费，一次炸锅的人工和损失就全兜回来了。 <br> 主要是你要做多层负载均衡，这系统架构就简单不了。你这好几台 ECS 要搞监控，报警，维护，等等一系列东西下来成本并不低。而且这对于你们来说也不是核心系统，你也要考虑花大精力去调查维护这东西到底值不值。 <br> 我觉得你有精力折腾这个，只为了节省这么点流量费，不如花点时间去跟云厂商要点折扣。或者把这些大文件存储业务单独换到别的更便宜的厂商去做更靠谱一点。
- > 另外 MiniIO 还有 License 问题，你要考虑你的情况是否适用他那个 AGPL 的 License 。因为你这种架构本质上是在云平台上使用 MiniIO 搭建了对象存储服务，并提供给你的客户（如果你客户是直接拿链接从这个服务里下载文件的话）。 <br> 那么根据 AGPL ，你需要公开相关的所有代码。 <br> 本身 AGPL 就不是个很严谨的 License ，MiniIO 选择它也就是看中了这点，好方便他们推自己的商用 License ，所以大家当时都在骂。如果你的公司比较看重法务合规这块，那还是别省这么点流量费了。
  >> 感谢回复，您的回复对我而言十分有用。另外，如果是把 MinIO 部署到内网上，也需要公开相关的所有代码吗？
- > ***分享下我们在用的低成本自建 OSS 方案：阿里云买 2 台轻量 200M 机器做前端入口，普通 ECS 带块大硬盘，两者之间走内网***。只需要几百块，就能得到不限流量大带宽（晚高峰限速）大空间的自建存储，比直接用 OSS 要买好几个套餐包划算很多。
- > 社区就是这样，你是来提问的，大家不是你家长，不会惯着你。1 楼已经说的很明白了，你听不懂还嫌人家态度不好。 <br> ***`MinIO` 、`CephFS` 之类的东西，本来就是低成本的`线下内网部署`***，你在高溢价的云服务器上部署，根本不划算，***而且这种云服务器最贵的就是外网带宽。就算要用云服务，直接去买云对象存储会更好***，所以 1 楼才问你：图啥。
- > 我觉着还是用在内网吧。。我觉着能用 oss 之类的，还是 oss，自建需要强大的能力和精力。当然，一两个节点也许是可以的。不过一两个节点不如多搞几块盘跑单机啊。。。
- > 说实在的, 有 OSS 不用非得自己搭. 图啥啊?自建存在以下问题:
  ```console
  - 安全措施 (即使 MINIO 有账户校验和链接校验, 但只要有漏洞数据就全丢了)
  - 磁盘限制 (云厂商提供的硬盘是按照容量分配 IOPS 的, 你容量越小, IO 越小. 存个大文件直接把 IO 吃满了)
  - 带宽限制 (你也说了带宽瓶颈了, 既然你是对外提供服务, 为什么不选择 CDN ?)
  - 高可用 (自建没有现成的好)
  ```
  > PS: 如果只是出于学习的目的, 那尽管折腾.
- > 我们这边用下来。建议直接 `CDN+OSS` 的方案，可能成本比你买服务器的硬盘便宜。如果这么搞的话，你甚至可以把外网带宽缩了，api 访问用不到这么大的宽带。
- > 这么多人都支持用云产品，我提个反例。`aws` 的`极光数据库`，真的拉跨，又贵吧，还它瞄的恢复又慢。自建的话便宜多了。所以我支持自建，总以为它们水平很高，结果啪啪打脸。
- > 我们用 minio 都是在内网 公网都是 OSS 如果一定在云上那还是用 OSS 最好
- > 如果你仅仅是因为 OSS 外网流量价格高而部署 MinIO ，那不去直接 ECS 反代 OSS ，OSS 内网流量应该是免费的。

基于对象存储构建数据库、消息系统等基础软件已经成为一种新趋势了吗？ https://www.v2ex.com/t/1023663
```console
消息系统
- Confluent: 兑现了 Kafka KIP-405 的分层存储能力，将大量数据存储到 S3 来缓解其数据复制的压力和降低存储成本。
- WarpStream: 闭源产品，兼容 Kafka API 的一个 Kafka 替代品，完全将 S3 上作为主存储。
- Redpanda: 开源产品，可以看作是 Kafka 的一个 rust 实现版本，存储层也实现了和 Confluent 类似的分层存储来降本。
- AutoMQ: 国人的开源产品，对 Kafka 底层存储做重新改造实现了一个存算分离的 Kafka 。底层也依赖对象存储作为主存储来进行降本。
- Pulsar: 国人的开源产品。前面的都算 Kafka 生态的，这个属于自建生态。主打一个存算分离，也支持将数据卸载给对象存储来降本。
- RocketMQ: 国人开源产品，在阿里在线业务大面积应用而发扬光大。5.x 冷热分离后也实现了类似 Kafka 的二级存储，冷数据可以利用对象存储降本。

数据库
- Snowflake: 应该是云原生基础软件的标杆产品，算是最早开始充分挖掘对象存储无限容量、弹性、低成本潜力的企业了
- TiDB: 23 年开始应该也是洞悉到了这个趋势，后来推出了基于 S3 对象存储的 TiDB Serverless

其他还有很多软件，你看他们软件迭代的 roadmap ，基于都可以观察到，对象存储重塑基础软件似乎已经成为了一个潮流。不过仔细想想，这也合理，对象存储提供了太多优异的特质了：
- 无限的存储容量：无限扩展的容量
- 近乎无限的吞吐：几十 GB/s 的吞吐（不够可以找云厂商再开 limit ）
- 极致弹性，pay-as-you-go: 按照 API 、实际存储容量来按需收费。用多少花多少钱
- 内建免费的跨 zone 多副本容灾：内建可用区容灾的能力，而且免流量费。基于对象存储构建具备跨可用区容灾能力的应用将会非常轻松。
- 极低的存储存本：相比其提供的技术能力来看，其存储成本非常低，比 SSD 有一个数量级的成本优势
```
- > 其实主要还是为了适应 Serverless 的趋势，上云降本增效。
  >> 是的，本质是对象存储是一个非常好的弹性基础存储设施。不过云下也不是不能做，自己用 minio 这类开源对象存储解决方案成本也比使用 ssd 低廉的多。
- > 云场景、实时性要求不高的场景有成本和灵活性优势，非云场景或者实时性要求高的场景就不适合了
  >> 实时性要求高可以配合小容量的云盘来做软件设计呀。小容量的 SSD （小于 10GB ）每个月就几十块，automq 就是这么干的。非云场景本质和云是一样的，只不过是私有云，没有云规模化的技术红了和成本优势。自建机房自己配 minio+ssd 也一样的。
- > 我再补充两个有意思的项目：
  ```console
  1. neon： https://github.com/neondatabase/neon
  2. dolt： https://github.com/dolthub/dolt
  ```
  * > 里面基于对象存储做了很多数据共享方面的产品创新。云计算聚集了超大的规模，“无限容量”的低成本对象存储将成为数据密集型软件的唯一选择，同时基于共享存储的各类数据互通，格式互认，甚至完全的 Zero ETL 都正在发生。
- > 把软件架构里部非随机、非高密读写的存储功能放到对象存储，大概是最具有可操作性的云原生化了。 <br> 一个软件系统里真需要高频随机读写，不能日志化的操作，其实不会很多的。
- > 补充下：redpanda 是 C++写的，不是 rust ，上面写的有误更正下

Linux 下，大存储(84Tb)选什么文件系统好？ https://www.v2ex.com/t/865940
- > 盘多的话 zfs ，盘少随意
- > openzfs
- > 一般的话 ext4 xfs 都行，zfs 的话需要大内存 ECC 内存条，要求高些。
  >> 12 个 16T 的机械硬盘做的 raid10 用 H710min 卡做的 <br> 内存有很多。几百个 G 都有。
  >>> zfs 属于软 raid ，一般用 hba 卡。如果硬 raid 就没必要用这个文件系统了，ext4 xfs 都可以
- > xfs 正解
- > 别用 ext4 ，没 xfs 稳定
- > min.io 最好了解一下，万一要扩呢。
