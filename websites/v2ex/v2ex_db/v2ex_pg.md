
Postgresql å‡çº§é—®é¢˜ https://www.v2ex.com/t/906314

postgresql é‡Œé¢çš„äº‹åŠ¡ï¼Œæ˜æ˜åˆé”™è¯¯ä¸ºä»€ä¹ˆä¹Ÿæ‰§è¡Œäº†ï¼Ÿ https://www.v2ex.com/t/882893
- > æ²¡æ¯›ç—…ï¼Œä¸¤æ¡è¯­å¥éƒ½æ‰§è¡ŒæˆåŠŸäº†ï¼Œæ‰€ä»¥äº‹ç‰©æˆåŠŸäº†ã€‚ç¬¬ä¸€æ¡æ›´æ–° 1 æ¡è®°å½•ï¼Œç¬¬äºŒæ¡æ›´æ–° 0 æ¡è®°å½•ï¼Œéƒ½æ‰§è¡ŒæˆåŠŸã€‚
ä½ é—®çš„åº”è¯¥æ˜¯ï¼Œæ€ä¹ˆè®©æ›´æ–° 0 æ¡è®°å½•çš„æ—¶å€™ update è¯­å¥å¤±è´¥ï¼Œè€Œä¸æ˜¯æˆåŠŸã€‚ä½ å¯ä»¥åœ¨ update ä¹‹ååŠ  returning id ï¼Œè¿”å›å—åˆ°æ›´æ–°å½±å“çš„è¡Œçš„ä¸»é”®ã€‚è¿™æ—¶å€™ 0 æ¡è®°å½•æ›´æ–°çš„æƒ…å†µä¸‹ï¼Œä¼šç›´æ¥å¤±è´¥ã€‚

åœ¨ PostgreSQL ä¸Šé¢æœ‰ä¹ˆæœ‰ç±»ä¼¼ç¾å›¢ SQLAdvisor çš„å·¥å…·ï¼Ÿ https://www.v2ex.com/t/874067
```console
åŸºäº MySQL åŸç”Ÿæ€è¯æ³•è§£æï¼Œç»“åˆåˆ†æ SQL ä¸­çš„ where æ¡ä»¶ã€èšåˆæ¡ä»¶ã€å¤šè¡¨ Join å…³ç³» ç»™å‡ºç´¢å¼•ä¼˜åŒ–å»ºè®®ã€‚ https://github.com/Meituan-Dianping/SQLAdvisor
```

æ€ä¹ˆå¯¹æ¯” postgres æ•°æ®åº“æ•°æ®å˜åŒ– https://www.v2ex.com/t/872353
- > audit.audit_table
- > æˆ‘è§‰å¾—æ˜¯éœ€è¦çš„æ˜¯ CDC(change data capture), å¯ä»¥ä½¿ç”¨ç±»ä¼¼ WAL æˆ–è€… audit_table è¿™ç±»ï¼›è¿˜æ˜¯ç±»ä¼¼ç‰ˆæœ¬ç®¡ç†çš„é‚£ç§
- > æ„Ÿè§‰ä½ éœ€è¦çš„æ˜¯ CDC -- https://airbyte.com/blog/change-data-capture-definition-methods-and-benefits

è¯·æ•™å„ä½è€å“¥ï¼Œ PostgreSQLã€PostGIS åŸºäºåœ°ç†ç©ºé—´çš„æŸ¥è¯¢å¦‚ä½•ä¼˜åŒ–é€Ÿåº¦ï¼Ÿ https://www.v2ex.com/t/852771

PostgreSQL åˆ†é¡µæŸ¥è¯¢ CPU åƒæ»¡çš„é—®é¢˜ https://www.v2ex.com/t/797877
```console
ç–‘é—®
æ•°æ®åº“æœåŠ¡å™¨é…ç½® 20 æ ¸ 32Gï¼Œå•æœºã€‚100 å¹¶å‘æŒç»­æ—¶é—´ 180 ç§’å¯¹æŸä¸ªç®€å•åˆ†é¡µæŸ¥è¯¢æ¥å£è¿›è¡Œå‹æµ‹ã€‚
æœŸé—´åº”ç”¨æœåŠ¡å™¨æ­£å¸¸ï¼Œæ•°æ®åº“è¿æ¥æ­£å¸¸ï¼Œä½†æ•°æ®åº“æœåŠ¡å™¨ CPU å æ»¡ï¼Œè¯·é—®è¿™æ˜¯æ­£å¸¸ç°è±¡è¿˜æ˜¯å•¥é—®é¢˜....

sql
å•è¡¨åˆ†é¡µçš„é¦–é¡µæŸ¥è¯¢ï¼Œè¡¨å†… 1000 ä¸‡æ•°æ®ï¼Œç­›é€‰å‡ºçš„æ•°æ®ä¸º 28wï¼Œå¤§æ¦‚ sql å¦‚ä¸‹ï¼š
SELECT a,b,c,d,e FROM table WHERE del_flag = 0 AND c LIKE 'c%' order by e desc limit 10
SELECT COUNT(*) FROM table WHERE del_flag = 0 AND c LIKE 'c%'
```
- > å¤§è¡¨ä¸è¦ count
  >> ä¸šåŠ¡éœ€è¦ï¼Œæ— å¯é¿å…å•Š
  >>> ä¸šåŠ¡ä¸Šå¯ä»¥ç¼“å­˜è®¡æ•°.
  >>>> å®Œäº†.å¸¦ like..å½“æˆ‘æ²¡è¯´.æŸ¥è¯¢æ¡ä»¶å¤šå˜çš„è¯ç¼“å­˜ä¹Ÿæ•‘ä¸äº†
- > `EXPLAIN` çœ‹ä¸‹ç´¢å¼•æ˜¯å¦è®¾ç½®æ­£ç¡®ã€‚å¦å¤–å¦‚æœä¸šåŠ¡ç»å¸¸ä½¿ç”¨ `COUNT(*)` ï¼Œå»ºè®®æŠŠç›¸å…³å€¼æ”¾å…¥å†…å­˜ç¼“å­˜æˆ–è€…ç¼“å­˜è¡¨ã€‚
  >> å¸¦ `LIKE` çš„è¯æ•ˆç‡ä¸å¤ªå¥½ä¼˜åŒ–äº†å°±ã€‚é™¤éä¸Šä¸€äº›æ¯”è¾ƒå¤æ‚çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚æœç´¢æ•°æ®å…¨é‡è¿›ç¼“å­˜åç»­è¯»å–é ç¼“å­˜ï¼Œä»¥åŠå•ç‹¬çš„æ£€ç´¢æœåŠ¡å™¨ä¹‹ç±»çš„ã€‚ 
- > æŸ¥è¯¢æ¡ä»¶å¤šå˜çš„æƒ…å†µå¦‚ä½•å¤„ç†å‘¢ï¼Œè¿™ä¸ªå€¼å¾ˆéš¾ä¿è¯å‡†ç¡®å§ã€‚ã€‚ã€‚
  >> åŠ  `gin ç´¢å¼•` & `pg_trgm` æ¨¡å—æ˜¯ä¸ªå¯ä»¥å°è¯•çš„åŠæ³•ã€‚ä¸è¿‡å¾—åˆ†æä¸‹ä¸»è¦çš„æŸ¥è¯¢æ–¹å‘äº¤ç»™ DBA çœ‹çœ‹æ€ä¹ˆåŠ æ¯”è¾ƒä¼˜åŒ–ã€‚
- > æ–°ç‰ˆæœ¬ ç´¢å¼• æœ‰ä¼˜åŒ– <br> pgsql ä¸(å‚»ç“œ)æ”¯æŒå¿½ç•¥å¤§å°å†™æŸ¥è¯¢ï¼Œä¸šåŠ¡å¼€å±•æœ‰å›°æ‰°å—ï¼Œå…¶å®ƒå‡ ä¸ªå…³ç³»å‹æ•°æ®åº“éƒ½æ”¯æŒ <br> oracle mssql mysql èµ·æ­¥ 300Mï¼Œè€Œ pgsql åªéœ€è¦ 30Mï¼Œè€Œä¸”æ€§èƒ½æµ‹è¯„è¿˜å ä¸Šé£ï¼Œå¯¹äºä¸ªç«™å°ğŸ”éƒ¨ç½²ä¼˜åŠ¿å·¨å¤§ï¼Œå°±å¡åœ¨å¤§å°å†™æŸ¥è¯¢çš„é—®é¢˜(ç”¨ EFCore)
- > del_flag å’Œ c éƒ½æœ‰ç´¢å¼•å˜›ï¼Ÿ
  >> å‰è€…æ— ï¼Œåè€…æœ‰
  >>> çœ‹çœ‹è¿™ä¸ª https://github.com/digoal/blog/blob/master/201801/20180119_03.md
- > å¯ä»¥æŒ‡å®šæ…¢ sql ä½¿ç”¨æŸä¸ª cpu æ ¸å¿ƒ, è®©è¿™ä¸ªæ ¸å¿ƒæ…¢æ…¢è·‘å°±æ˜¯äº†. æ¯”å¦‚ 8C16G, æ‰“æ»¡ä¸€ä¸ªæ ¸å¿ƒ, cpu å ç”¨ç‡ä¹Ÿå°± 12.5%

PostgreSQL çš„ pg_try_advisory_xact_lock æ­£ç¡®ä½¿ç”¨å§¿åŠ¿æ˜¯ä»€ä¹ˆ https://www.v2ex.com/t/787443
- > https://github.com/digoal/blog/blob/master/201707/20170720_01.md  google ç¬¬ä¸€é¡µå°±æœ‰

PG ä¹Ÿä¸å­¦å¥½ https://www.v2ex.com/t/785716
```console
ä»Šå¤©æ‰çŸ¥é“ï¼ŒåŸæ¥ PG é»˜è®¤ä¹Ÿæ˜¯å¯ä»¥åœ¨ INTEGER å­—æ®µä¸Šå†™å…¥ä»¥å­—ç¬¦ä¸²è¡¨ç¤ºçš„æ•°å­—çš„ã€‚ä¹Ÿä¼šæŠŠæ•°å€¼è½¬æˆå­—ç¬¦ä¸²å†™å…¥ VARCHAR å­—æ®µï¼Œåªæœ‰å®½åº¦é™åˆ¶ã€‚
æˆ‘è¿˜ä»¥ä¸ºåªæœ‰ MySQL æœ‰è¿™ç§è¡Œä¸ºã€‚
```
- > PG æœ¬æ¥å°±æœ‰å¾ˆå¤š IMPLICIT CASTï¼Œç”šè‡³ä½ å¯ä»¥è‡ªå®šä¹‰ CAST ã€‚
- > ä¸è¿™æ ·çš„è¯ï¼Œsql ä¸­æ€ä¹ˆè¡¨è¾¾ datetime ç±»å‹å‘¢
  >> ä½ è¿™ä¹ˆä¸€è¯´ç¡®å®æœ‰é“ç†äº†ã€‚
- > å¸¸é‡å®šä¹‰é‡Œï¼Œdataï¼Œtimestampï¼Œinterval è¿™ä¸€ç±»å˜é‡å‰é¢éƒ½å¯ä»¥ç”¨å…³é”®å­—+å­—ç¬¦ä¸² è¡¨ç¤ºæ˜¯æŸç§ç±»å‹çš„å˜é‡ã€‚éšå¼è½¬æ¢åœ¨å¾ˆå¤šæ•°æ®åº“ä¸­éƒ½å­˜åœ¨çš„

PostgreSQL ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ direct IOï¼Œè€Œè¦ä¾èµ– os page cahceï¼Ÿ https://www.v2ex.com/t/752942

postgres ç”¨æˆ·ç™»å½•é—®é¢˜ https://www.v2ex.com/t/730231
- > è§£å†³äº†ã€‚ã€‚ã€‚ã€‚æ²¡æ³¨æ„åˆ°ä¸Šé¢çš„é‚£ä¸ª postgresï¼Œä¸€ç›´ä¿®æ”¹çš„æ˜¯ä¸‹é¢é‚£ä¸ªä¸¤ä¸ª all çš„ã€‚ã€‚ã€‚ã€‚ 
  ```conf
  # Database administrative login by Unix domain socket
  local all postgres md5
  
  # TYPE DATABASE USER ADDRESS METHOD
  
  # "local" is for Unix domain socket connections only
  local all all md5
  ```
- > -h èµ° tcp socket. ä¸åŠ èµ° unix domain socket.

å°±æƒ³é—®é—®å¤šå°‘äººçŸ¥é“ PostgreSQL ï¼Ÿ https://www.v2ex.com/t/729909

Postgres to_timestamp() æ— æ³•è½¬æ¢ unix epoch å­—ç¬¦ä¸² https://www.v2ex.com/t/712510

å¦‚ä½•æŸ¥çœ‹ pg data/base/dboid ä¸‹æ¯å¼ è¡¨é‡Œéƒ½æ˜¯å•¥ä¸œè¥¿ https://www.v2ex.com/t/700663

emmm æ²¡å¤ªèƒ½ç†è§£, ä¸ºå•¥æˆ‘ç”¨ postgres çš„ dbowner å»è®¿é—®åº“ä¸­çš„è¡¨ï¼Œè¿˜æ˜¯æ²¡æƒé™ https://www.v2ex.com/t/700398

æ±‚é—®å„ä½ V å‹ PG åº“çš„æ‰¹é‡æ’å…¥é—®é¢˜ https://www.v2ex.com/t/692169

PG åº“ï¼ŒæŸ¥è¯¢ä¼˜åŒ–ã€‚ https://www.v2ex.com/t/677846

PostgreSQL æœ‰æ²¡æœ‰åŠæ³•ç»Ÿè®¡æ¯ä¸ª SQL æ‰§è¡Œçš„æ¬¡æ•° https://www.v2ex.com/t/677366
- > pg_stat_statements è¿™ä¸ªæ’ä»¶
- > Redhat Debezium å¯ä»¥ç›‘æ§æ‰€æœ‰çš„æ•°æ®æ“ä½œï¼ŒEDA æ¡†æ¶ï¼Œå¯ä»¥å‘é€ Apache kafka ç­‰ã€‚ https://debezium.io/ <br> å…¶å®è¿™ä¸œè¥¿å®ç°ä¹Ÿä¸æ˜¯å¤ªéš¾ï¼Œåœ¨ SQL æ‰§è¡Œä¹‹å‰åŠ å…¥ Hookï¼Œ é€šè¿‡æ¶ˆæ¯å‘é€åˆ°è‡ªå·±çš„ç»Ÿè®¡æ•°æ®åº“ï¼ˆæ¯”å¦‚ Redis ï¼‰é‡Œé¢å»ã€‚
- > æ—¥å¿—å¼€å¯ sql è®°å½•ï¼Œpgbadger åˆ†ææ—¥å¿—
- > https://www.postgresql.org/docs/current/pgstatstatements.html

é—®ä¸€ä¸ª postgresql ä¼ å‚é—®é¢˜ https://www.v2ex.com/t/664998

é‡åˆ°ä¸€ä¸ª PostgreSQL å¾ˆå¥‡è‘©çš„æ’åºé—®é¢˜ï¼ˆBUGï¼Ÿï¼‰ https://www.v2ex.com/t/663098

PostgreSQL ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹å­—ç¬¦ä¸²è¿›è¡Œæˆªå–çš„æ–¹æ³• https://www.v2ex.com/t/654241
- > `select regexp_replace(str,'.*(A\d{10}).*','\1','g')`
```sh
# ä¸ªäººè¯•äº†ä¸€ä¸‹ï¼š

$ docker volume create pgdata
pgdata
$ docker run --name postgres -e POSTGRES_PASSWORD=2018 -d -p 54320:5432 -v pgdata:/var/lib/postgresql/data postgres:9.6
// ...
// æ‹–é•œåƒè¿‡ç¨‹è¾“å‡ºçœç•¥
// ...
$ docker exec -it postgres bash
root@93ace25c5739:/# 
root@93ace25c5739:/# psql -U postgres
psql (9.6.17)
Type "help" for help.

postgres=# select regexp_replace('é˜¿è¨æ¡†æ¶è·å¾—æ’’é˜¿æ–¯è¾¾ A3829232472 å®¶å¿«æ·é”®', '.*(A\d{10}).*', '\1', 'g');
 regexp_replace
----------------
 A3829232472
(1 row)

postgres=# select regexp_replace('000A3829232472000', '.*(A\d{10}).*', '\1', 'g');
 regexp_replace
----------------
 A3829232472
(1 row)
```

:u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272:
