
昨天和领导一起面试了一个牛逼疯了的前端高级开发/前端架构师 https://www.v2ex.com/t/696441
```console
然后因为难得遇见这种大佬，我就自己算是请教了几个问题。

第一，如果是很大的项目，需要部署多个服务器。
那怎么提前预估，需要的带宽，机器配置，机器数量。
他吧啦吧啦说了些，我就听懂了个他说之前有在华为做过，自己遇到就参考华为的方案。

第二，我问他如果是多服务部署，做了负载均衡。
那么一个用户在 A 服务器登录了，后面的请求又被负载均衡到了 B 服务器上。
那这个用户的登录信息，session 信息怎么办。
他说服务器之间会同步这些用户登录信息。
我就追问，那岂不是每一台机器都复制了一份其它服务器的登录信息？
他就说是的，然后马上说实际上他们有一个专门的服务器存储登录信息，不用互相同步。
讲完了他可能发现这个设计不对，自己说这种设计如果登录信息存储的服务器挂了，
那么可能所有服务器都会收影响。也没说后续怎么解决这个问题。

第三我问他，如果大项目，部署了多台服务器。那一天我需要更新站点,
那怎么保证多台服务都能更新好了以后再对外提供服务。
而不是出现一半服务器更新好了，一半服务器还是旧的。
他也吧啦吧啦了半天，反正我也没听懂。
```
```console
1 、维护中国门户网站 1000 万 pv 访问量，前端服务和线上更新、处理日常故障及 dns 服务维护。
2 、 负责 relay 跳转机维护及服务器账户管理。
3 、 负责 Ansible 日常维护 1000 台服务器，修改配置、按各组需
求修改 puppet 管理文件。
4 、 负责虚拟化技术实施，虚拟机批量安装部署，资源分配及资
产管理。
5 、 部署维护监控平台（ cacti 、Zabbix 、nagios ）和银行开发监控平台的维护，2018 年 11 月 - 至今
2018 年 04 月 - 2018 年 11 月 基于 Zabbix 监控+监控项目&实现邮件、微信报警

贴一段他的简历。我实话实说，我一个中级前端，我真不懂多少。
```
- > 多服务器压根就不同步会话信息。权限验证会在网关层处理，如果接口需要鉴权而本身请求权限过期(可以放在 cookie 或者 header 里)，网关层会直接 401 拦截回去。登录校验的信息会放在 redis 集群内。后端服务拿到的都是经过网关处理以后的 userId，再根据 userId 去解析当前应用的数据权限
- > 肯定是 redis 共享啊，分布式数据无非就是保证 ACID 那一套，方法是一致的，实现有很多方法
- > 
  ```
  session 这个问题

  第一可以不用 session，鉴权信息可以用 JWT Token 之类的方式去存。其他的尽量规避使用 session
  第二可以用中心化 Session，比如 Redis，通过 Redis 主从或者集群的方式提高其可用性就行了。
  第三就算不用中心化 Session，如果能保证 session 数据丢失也只是用户需要重新登陆下，无关键信息。那么就可以通过 LB 做 IP HASH，
      保证来源 IP 只落在固定的后端服务器上，那么 session 保存到服务器内存里就行了。如果服务器出了问题，大不了就是用户重新登陆下。
  ```
- > 讲真，我看了下你贴的他的简历，他的那些工作和我的差不多，而我给自己的定位为中等偏下。还有你说的 session 共享的问题，在云平台的网络层面可以做会话锁定，52L 已经讲解了这个问题源 IP 会持续指向首次访问成功的后端机器直至会话结束。
- > Header 字段做负载均衡需要 7 层 LB，IP HASH 负载均衡 4 层 7 层都可以。所以要看实际情况的限制
- > 突然想到有这么一个仓库： https://github.com/donnemartin/system-design-primer
  >> https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md
- > 用负载均衡 session 应该是放在 redis 中吧，不同的后端实例都用同一个 redis 。或者用 jwt，不过对 CPU 计算任务就增加了
- > 
  ```
  "第一，如果是很大的项目，需要部署多个服务器。那怎么提前预估，需要的带宽，机器配置，机器数量。"
  这个得看具体业务,提前预估基本等于扯淡
  
  "第二，我问他如果是多服务部署，做了负载均衡。"
  分布式集群利用 redis 存储 session 做无状态是基础常识,做后台开发第一年就碰得到
  
  "第三我问他，如果大项目，部署了多台服务器。那一天我需要更新站点,那怎么保证多台服务都能更新好了以后再对外提供服务。"
  蓝绿发布、灰度发布和滚动发布,也是很简答的东西

  全文都是槽点
  ```
- > jwt 主动失效不好搞吧，要是在 jwt 上再开发失效方案约等于重新实现 session，感觉还是 session 类的方案好些
- > jwt 最好结合 oauth2，一般失效时间 1h，定时 refresh。其实不是很适合 web 使用，更适合 api 使用。web 还是 session 简洁方便一些。
- > cookie 过时倒不至于……但现在都是多端，但 cookie 只支持 web……你要有个移动 APP 或者桌面 APP，就玩不转了。so，就需要 token 这种客户端类型无关的技术。
  >
  > cookie-session 是 web 专有的，解决不了多端的问题。用 token 替代 cookie 并不存在滥用的问题。
- > 第二，简单点是做 session 绑定，一个用户的请求只到某一台服务器，缺点是有一台服务器挂了，用户就要重新登录。 <br> 完整点就做分布式 session，所有服务器都到统一的地方获取 session 。常用的是 redis，通过 redi 集群保证高可用。
  >
  > 第三，其实是灰度发布，更新服务器前先从负载均衡，如 F5 等拉出，发布完成后再拉入。知道全部更新完成。
- > 想了想，不对吧，app 或者桌面端，他请求数据不一样走 http 请求吗？只要走 http 不就能用 cookie-session 这一套吗？

[长篇娱乐连载] 网络的那些事儿（S01E04）国内带宽的价格 (IDC/DC 行业内幕) https://www.v2ex.com/t/693018

阿里面试，一个对你而言很陌生的线上系统启动慢，你会如何排查问题？ https://www.v2ex.com/t/692719
- > 主机虚拟内存使用情况； netstat 看看 Recv-Q Send-Q 情况，有时候 DNS 反向解析也可能会导致慢或者一部分功能不可用。
- > 无脑 arthas
- > ng 查看下回复时间，排查是否网络原因；是否 io 密集型任务排查下系统 io 情况； cpu 是否高占用，如果高占用具体排查线程，是 gc 线程还是用户线程。数据库是否有慢查询，缓存连接情况，mq 消费是否正常，是否有三方接口响应过慢。大方向具体就想到那么多。
- > 是启动慢还是系统慢，如果只是启动慢，那说明线上没问题呀，加点日志，下次上线时看看启动到底哪里慢；如果是接口慢，那就看看系统负载瓶颈呗，是 cpu 满了，内存不够了还是网卡爆了
- > 启动慢又不是运行慢，模拟线上环境在线下尝试复现呗。 <br> 线上即然已经上线，启动慢就不是问题，先封禁变更放着，没必要在线上 debug。 <br> 如果线下无法复现，就在线上找个实例，从 LB 上把流量摘了，随便打点加日志折腾

谈谈我为什么喜欢声明变量时类型后置的语言 https://www.v2ex.com/t/678294

关于断言的一个疑问，希望可以和懂的人讨论一下，请不吝赐教。 https://www.v2ex.com/t/671078

最终一致性到底是什么？？ https://www.v2ex.com/t/666807
- > https://zhuanlan.zhihu.com/p/47445841 
  <br> 单机场景一致性主要看并发隔离 
  <br> 分布式场景一致性主要看怎么获得全序关系 
  <br> 一致性门道很多，不系统性的学习根本就弄不清楚的；可以看看 DDIA 这本书
- > 不要弄混 ACID 中的 C 和 CAP 的 C，前者的重心在于系统整体的一致性, 后者指的是多个副本之间的一致性
- > 14 楼说得并不对，理解太浅显 
  <br> ACID 里面的 C 定义非常模糊，与业务定义有关，ACID 这几个概念就不正交；单机数据库谈论 ACID 比较多，AID 是对 C 的约束 
  <br> CAP 里面的 C 也不是指什么副本一致，而是指线性一致性（也就是大家谈论的强一致，但其实大部分人自己是说不清楚什么是强一致的），还是去看书吧，这个需要扎实的理论基础
- > 分布式事务的一致性还是事务的一致性，即业务层面定义的一致性。分布式事务相对与单机事务的难点是：因通信不稳定，参与事务的各个‘进程’如何对状态达成一致。这是个共识问题。
至于 CAP，通常网络 P 很可能发生，无法避免（看到有人说谷歌自建网络非常稳定，不会出现 P ）。所以只能在 CA 上做权衡，C 强一点，A 就弱一点。CA 好像是某个概念（延迟？）的一体两面。建议参考 
  * > http://jepsen.io/consistency
  * > https://www.zhihu.com/people/zhangshuai89/posts
    + CAP，ACID，我们能做什么 - 张帅的文章 - 知乎 https://zhuanlan.zhihu.com/p/37076900

请教一下，阅读 Linux Kernel 最快的解决方案（@Windows）是啥呢? https://www.v2ex.com/t/656319
- > https://elixir.bootlin.com/linux/v5.6-rc7/source
- > https://elixir.bootlin.com/linux/latest/source
- > qtcreator，很久前看内核源码是用这个，现在 c/c++源码基本也是这个。另外，添加源码的时候，不要把所有`**_arch` 都加到工程，只加关注的几个
- > neovim + ctags，然后用 vim 插件 leaderF，堪称搜索神器
- > 使用 sourcegraph https://sourcegraph.com/github.com/torvalds/linux

关于 RSA 的一些趣事 https://www.v2ex.com/t/655096

有无计算机组成原理相关的课程和书推荐 https://www.v2ex.com/t/625781

做一个基础很扎实的程序员是一种什么感受啊 https://www.v2ex.com/t/561411
- > 现在开始学基础也不会晚。最近也一直在看计算机基础相关圣经。我整理了一个计算机基础书单，可以参考参考 https://github.com/tagnja/resources-of-learning/blob/master/%23cs-foundations.md

推荐几篇零知识证明技术博客文章 https://www.v2ex.com/t/586006
> 深入浅出区块链 https://learnblockchain.cn/

翻译了一下破解编码面试这本书，放到 GitHub 上了 https://www.v2ex.com/t/609497
> https://github.com/F8F-1BearCat/CtCI-6th-Edition-CN

:u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272::u5272:
