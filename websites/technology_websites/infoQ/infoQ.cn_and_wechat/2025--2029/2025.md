
# 04

从 SQLite 到 DuckDB：查询快 5 倍，存储减少 80% https://mp.weixin.qq.com/s/yKDhBCc4n_7mZ_HC-XPJiA
- > 为什么选择 DuckDB
  * > 我们需要一个能够嵌入到应用中，同时又快速且可靠的数据库系统。SQLite 和 DuckDB 都可以满足这些要求，***但我们发现 DuckDB 在执行分析查询时比 SQLite 快 `3 到 5 倍`，而且随着数据量的增加，这种优势更加明显***。
  * > SQLite 逐行处理数据，而 DuckDB 使用列存储矢量化执行引擎，同时处理大量值。这种处理方式特别适合我们的分析工作负载。
  * > `ClickBench` 基准测试显示，在某些分析查询中，DuckDB 的性能比 SQLite 快了多达 1200 倍。
  * > 尽管 DuckDB 在我们的工作流程中读取性能显著优于 SQLite，***但在单行操作方面，它不如 SQLite。在我们的测试中，SQLite 在这些场景下比 DuckDB 快大约`两倍`***。
  * > 尽管如此，另一个促使我们选择 DuckDB 的关键因素是它的`自动磁盘压缩功能`，这个功能大大减少了存储空间。
  * > 我们创建了一个张表，与我们应用中使用的表类似，包含了`两个时间戳列、一个主键整数 ID 和一个布尔列`。***插入 `100 万行`数据后，SQLite 数据库文件大小为 `101.6MB`，而 DuckDB 仅需 `23.1MB`，体积减少了 `77%`***。
- > 迁移过程
  * > 迁移过程并非一帆风顺。SQLite 的编程语言生态系统支持比 DuckDB 要好得多。Trace 的大部分代码是用 Rust 编写的，我们使用 Diesel ORM 来处理数据库交互。
  * > DuckDB 也有自己的 Rust 包，即 duckdb-rs，但它并不是 ORM。因此，我们不得不重写代码库的核心部分，并自己实现了一个数据库迁移系统。
  * > 在重写过程中，我们还遇到了 DuckDB 的一些并发限制。***以前使用 SQLite 时，我们可以打开多个并发连接，对同一张数据库表执行操作。而使用 DuckDB 时，这种情况会导致大量数据丢失——一个连接的数据会被保存，另一个连接的数据则完全丢失***。解决这个问题并不难，我们只需要确保在任何给定时间只有一个线程可以修改一张表。
  * > 另外需要注意的是，***将 DuckDB 包含在我们的应用中几乎使应用包的体积翻倍，从 `26MB` 增加到 `44MB`***。虽然体积变大了，但对我们来说绝对值得。
- > 我们是否完全放弃了 SQLite
  * > 没有。尽管 DuckDB 在分析工作负载方面表现出色，***但我们仍然依赖 SQLite 来执行一些核心操作。SQLite 更适合处理频繁的小事务，因为它轻量，<ins>对简单查询速度更快</ins>，并且更有效地支持并发连接***。
- 回复：
  * > SQLite在骁龙X处理器上慢的要死，无论用Python，还是直接用命令行，导入大量csv文件，都会越来越慢，慢到根本无法忍受！
    >> 曾经记得，sqlite的话，插入大量数据了，开个事务会比多次插入速度快
    >>> 是的，插入5万条数据（wasm浏览器版），不开事务约好几分钟，开启事务几秒钟。别告诉浏览器都那么快，原生程序更慢！
    >>>> 使用事物批量插入，百万数据都是几秒钟搞定
    >>>>> 是不是没适配arm的simd加速指令集
  * > 没必要，差不多能用就行了，换个数据库学习成本和时间成本都得花，反正打工搞这么累干啥
  * > 之前用过，不支持多线程还是小问题。不支持多进程，一不小心用其他进程也来访问，数据就不对了[苦涩]
  * > h2数据库就很好用，数据量大时性能也很好
  * > 各类手机，嵌入式设备都选sqlite原因并不是它最快，而是它测试集完备，问题少
  * > 没必要
  * > rust怪

# 03

Apache Doris + Iceberg 超大规模湖仓一体实践 https://mp.weixin.qq.com/s/EKvDRkSwG4F-uA-W4TW18g

Rust粉丝破大防！TypeScript之父选Go语言重写编译器，性能飙升10倍引战：Rust不香了？ https://mp.weixin.qq.com/s/UurzobilFaT1D9jMsWu75A
- > **Rust 粉丝震惊：为何不选 Rust？！**
  * > 随着不满情绪的出现，TypeScript 首席开发者 Ryan Cavanaugh 出面做出澄清，承认他们已经预料到开发者社区就会此展开争论。
  * > 他提到，虽然 Rust 也是个不错的选择，但“决定性因素”在于可移植性，即如何确保新代码库在算法上与当前代码库保持一致。
  * > 他还透露，TypeScript 团队探索了多种方法来表示代码，检验用 Rust 重写代码是否可行。但其在性能和开发体验等方面带来了“不可接受的”问题。***某些方案需要单独实现垃圾收集器（GC），这会增加额外的复杂性***。
  * > ***与之形成鲜明对比的是，Go 语言具备内存自动回收机制，即所谓“垃圾收集”***。Cavanaugh 坦言，“虽然二者中的某些机制相当接近，但 Rust 往往需要使用大量不安全代码，而且 Rust 似乎缺少充足的原语组合来实现有益于开发者体验的 JavaScript 代码移植目标。”

# 02

FUSE，从内核到用户态文件系统的设计之路 https://mp.weixin.qq.com/s/5e1qePlAL0kdaIJo5FR4hw
- > `FUSE`（`Filesystem in Userspace`）是一个允许用户在用户态创建自定义文件系统的接口，诞生于 2001 年。FUSE 的出现大大降低了文件系统开发的门槛，使得开发者能够在不修改内核代码的情况下实现创新的文件系统功能。`JuiceFS` 就是基于 FUSE 构建的高性能分布式文件系统，充分发挥了 FUSE 的灵活性和扩展性。

Linus 将不顾反对合并Rust代码？！内核维护者无奈强调：不能让“癌症”扩散！ https://mp.weixin.qq.com/s/NDyXHG6fJhBCHdtTvnZo9A

Rust 补丁两年零通过，34年开发者煽动网友逼Linus表态，维护者激烈反击：Rust 就是 Linux 的“癌症”！ https://mp.weixin.qq.com/s/Xwi_uq29BQMx0_iQR3tFNg
